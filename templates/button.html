{% extends "upper.html" %}
{% block content %}
<div class="button-container">
    <h1>Followers</h1>
    <button type="button" class="btn btn-success send-data">0-500</button>
    <button type="button" class="btn btn-success send-data">500-1000</button>
    <button type="button" class="btn btn-success send-data">1000-1500</button>
    <button type="button" class="btn btn-success send-data">more than 2000</button>
</div>

<style>
    .active {
    background-color: #ff9800 !important; 
    color: white !important;
    }
</style>

{% for category in unique_categories %}
<div class="button-container">
    <h1>Category</h1>
    <button type="button" class="btn btn-primary send-data">{{ category }}</button>
</div>    
{% endfor %}

<button id="filter-button" class="btn btn-warning">Apply Filter</button>

<div id="output"></div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
<script>
    $(document).ready(function () {
        $(".send-data").click(function () {
            $(this).toggleClass("active");
        });

        $("#filter-button").click(function () {
            let selectedData = {};

            let followers = [];
            $(".btn-success.active").each(function () {
                followers.push($(this).text().trim());
            });
            if (followers.length > 0) {
                selectedData["followers"] = followers;
            }

            let categories = [];
            $(".btn-primary.active").each(function () {
                categories.push($(this).text().trim());
            });
            if (categories.length > 0) {
                selectedData["categories"] = categories;
            }

            $.ajax({
                url: "/promotional_site",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(selectedData),
                success: function (response) {
                    $("#output").html(response.html);
                },
                error: function (error) {
                    console.log("Error:", error);
                }
            });
        });
    });
</script>
{% endblock %}  
